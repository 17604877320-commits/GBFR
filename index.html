<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>GBFR å› å­å¯¹ç…§ Pro - @ç«‹å¤</title>
    <style>
        :root { --gold: #d4af37; --brown: #5d4037; --coffee: #eaddca; --bg: #fdfaf5; --green: #27ae60; --red: #e74c3c; }
        body { font-family: sans-serif; background: var(--coffee); margin: 0; padding: 10px; display: flex; flex-direction: column; align-items: center; }
        .main-layout { display: flex; gap: 15px; width: 100%; max-width: 1200px; align-items: flex-start; }
        
        /* å·¦ä¾§ï¼šç›®æ ‡æ¸…å•ä¸ç¥ç¦ */
        .left-panel { flex: 1.2; position: sticky; top: 10px; display: flex; flex-direction: column; gap: 15px; }
        .target-list, .weapon-status { background: var(--brown); color: #fff; padding: 15px; border-radius: 12px; }
        .target-item { display: flex; justify-content: space-between; padding: 6px 0; font-size: 12px; border-bottom: 1px solid rgba(255,255,255,0.1); }
        
        /* é¢œè‰²çŠ¶æ€ */
        .status-over { background: rgba(231, 76, 60, 0.2); color: var(--red) !important; font-weight: bold; }
        .status-met { color: var(--green) !important; }
        
        /* å³ä¾§ï¼šå› å­å¡«è¡¨ */
        .slot-section { flex: 2; background: var(--bg); padding: 15px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .slot-box { border: 1px solid #ddd; padding: 12px; border-radius: 10px; margin-bottom: 12px; background: #fff; }
        .bless-box { border: 2px solid var(--gold); background: #fffdf0; padding: 12px; border-radius: 10px; margin-bottom: 20px; }
        .input-row { display: flex; gap: 5px; align-items: center; margin-bottom: 5px; }
        select { flex: 2; padding: 8px; border-radius: 5px; border: 1px solid #ccc; font-size: 13px; }
        .lv-input { width: 50px; padding: 8px; border-radius: 5px; border: 1px solid #ccc; text-align: center; }

        .checkbox-row { display: flex; align-items: center; gap: 10px; margin-top: 5px; font-size: 14px; color: var(--gold); }
        button { margin-top: 10px; width: 100%; padding: 12px; background: var(--brown); color: var(--gold); border: none; border-radius: 8px; font-weight: bold; cursor: pointer; }
        
        @media (max-width: 850px) { .main-layout { flex-direction: column; } .left-panel { position: static; width: 100%; } }
    </style>
</head>
<body>
    <div class="header" style="text-align:center; margin-bottom:15px;">
        <h2 style="margin:0; color:var(--brown);">æ³½å¡”å› å­é‡åŒ–ä¸“å®¶ç³»ç»Ÿ</h2>
        <footer style="opacity:0.6; font-size:12px;">Author: @ç«‹å¤</footer>
    </div>

    <div class="main-layout">
        <div class="left-panel">
            <div class="weapon-status">
                <h4 style="margin:0 0 10px 0; color:var(--gold);">âš”ï¸ æ­¦å™¨é…ç½®</h4>
                <div class="checkbox-row">
                    <input type="checkbox" id="isBahamut" onchange="render()"> 
                    <label for="isBahamut">å¼€å¯æ»¡è§‰é†’å·´æ­¦ (å…¨æŠ€èƒ½+1)</label>
                </div>
                <div id="blessDisplay" style="font-size:12px; margin-top:10px; color:#ddd;"></div>
            </div>

            <div class="target-list">
                <h4 style="margin:0 0 10px 0; border-bottom:1px solid var(--gold)">å› å­ç›®æ ‡å¯¹ç…§ (å½“å‰/ç›®æ ‡)</h4>
                <div id="targetDisplay"></div>
            </div>
        </div>

        <div class="slot-section">
            <div class="bless-box">
                <div style="font-weight:bold; font-size:14px; margin-bottom:10px; color:var(--brown);">ğŸ’ æ­¦å™¨ç¥ç¦å½•å…¥ (ç­‰çº§ç‹¬ç«‹)</div>
                <div id="blessInputs"></div>
            </div>

            <div id="slotContainer"></div>
            <button onclick="resetAll()" style="background:#c0392b; color:#fff;">æ¸…ç©ºå…¨éƒ¨é…è£…</button>
        </div>
    </div>

    <script>
        // 1. æ³½å¡”æ¨èå±æ€§ä¸å…¶æœ€é«˜æœ‰æ•ˆç­‰çº§ä¸Šé™
        const capConfig = { "ä¼¤å®³ä¸Šé™": 65, "çƒ­è¡€": 45, "æš´å›": 45, "æ¿€æ˜‚": 45, "è¿…æ·": 45, "æ€’æ¶›": 20, "è¿½å‡»": 45 };
        
        const rawRecommended = ["çƒ­è¡€", "æš´å›", "å±è½¬", "æ¿€æ˜‚", "ç‹‚æˆ˜å£«", "è¯æ°´", "è¿½å‡»", "è¿½å‡»", "å¥‹ä¸é¡¾èº«", "æ˜é•œæ­¢æ°´", "èº²é¿æ€§èƒ½", "è‡ªåŠ¨å¤æ´»", "çƒˆç„°", "ç¿”èˆ", "æˆ˜æ°”", "è¿…æ·", "ç§˜çº¹Î±", "ä¼¤å®³ä¸Šé™", "ç§˜çº¹Î±", "ä¼¤å®³ä¸Šé™", "ç§˜çº¹Î³", "ä¼¤å®³ä¸Šé™", "ç§˜çº¹Î³", "ä¼¤å®³ä¸Šé™"];
        
        const targetConfig = {};
        rawRecommended.forEach(attr => { targetConfig[attr] = (targetConfig[attr] || 0) + 15; });

        const attrPool = ["ç©ºç¼º", ...new Set(rawRecommended), "æ˜å¥", "æ€’æ¶›", "è±ªèƒ†", "å›é¿è·ç¦»", "é«˜æ‰¬"];

        // æ•°æ®ç»“æ„
        let isBahamut = false;
        let blessSlots = [
            { attr: "æ˜å¥", lv: 20 },
            { attr: "è¿½å‡»", lv: 15 },
            { attr: "æ€’æ¶›", lv: 10 }
        ];
        let currentSlots = Array.from({length: 12}, () => ({ main: "ç©ºç¼º", sub: "ç©ºç¼º", lv: 15 }));

        function render() {
            isBahamut = document.getElementById('isBahamut').checked;
            const currentStats = {};
            const addLv = isBahamut ? 1 : 0;

            // ç»Ÿè®¡æ­¦å™¨ç¥ç¦
            blessSlots.forEach(b => {
                if(b.attr !== "ç©ºç¼º") currentStats[b.attr] = (currentStats[b.attr] || 0) + b.lv;
            });

            // ç»Ÿè®¡å› å­ (ä¸»å‰¯åŒæ­¥ç­‰çº§ + å·´æ­¦åŠ æˆ)
            currentSlots.forEach(s => {
                if(s.main !== "ç©ºç¼º") currentStats[s.main] = (currentStats[s.main] || 0) + (s.lv + addLv);
                if(s.sub !== "ç©ºç¼º") currentStats[s.sub] = (currentStats[s.sub] || 0) + (s.lv + addLv);
            });

            // æ¸²æŸ“å·¦ä¾§åˆ—è¡¨
            const targetDiv = document.getElementById('targetDisplay');
            targetDiv.innerHTML = Object.keys(targetConfig).map(attr => {
                const targetLv = targetConfig[attr];
                const currentLv = currentStats[attr] || 0;
                const cap = capConfig[attr] || 99; // æ— é¢„è®¾ä¸Šé™åˆ™é»˜è®¤ä¸º99
                
                let statusClass = "";
                if (currentLv > cap) statusClass = "status-over";
                else if (currentLv >= targetLv) statusClass = "status-met";

                return `
                    <div class="target-item ${statusClass}">
                        <span>${attr}</span>
                        <span>å®æµ‹ ${currentLv} / ç›®æ ‡ ${targetLv}</span>
                    </div>
                `;
            }).join('');

            // æ¸²æŸ“ç¥ç¦è¾“å…¥
            const blessDiv = document.getElementById('blessInputs');
            blessDiv.innerHTML = blessSlots.map((b, i) => `
                <div class="input-row">
                    <select onchange="updateBless(${i}, 'attr', this.value)">
                        ${attrPool.map(a => `<option value="${a}" ${b.attr === a ? 'selected' : ''}>${a}</option>`).join('')}
                    </select>
                    <input type="number" class="lv-input" value="${b.lv}" oninput="updateBless(${i}, 'lv', parseInt(this.value)||0)">
                </div>
            `).join('');

            // æ¸²æŸ“å› å­æ§½ä½
            const container = document.getElementById('slotContainer');
            container.innerHTML = currentSlots.map((slot, i) => `
                <div class="slot-box">
                    <div class="slot-title"><span>æ§½ä½ ${i + 1}</span> <input type="number" class="lv-input" style="height:25px" value="${slot.lv}" oninput="updateSlot(${i}, 'lv', parseInt(this.value)||0)"></div>
                    <div class="input-row">
                        <select onchange="updateSlot(${i}, 'main', this.value)">
                            ${attrPool.map(a => `<option value="${a}" ${slot.main === a ? 'selected' : ''}>ä¸»ï¼š${a}</option>`).join('')}
                        </select>
                        <select onchange="updateSlot(${i}, 'sub', this.value)">
                            ${attrPool.map(a => `<option value="${a}" ${slot.sub === a ? 'selected' : ''}>å‰¯ï¼š${a}</option>`).join('')}
                        </select>
                    </div>
                </div>
            `).join('');
        }

        function updateSlot(i, field, val) { currentSlots[i][field] = val; render(); }
        function updateBless(i, field, val) { blessSlots[i][field] = val; render(); }
        function resetAll() { if(confirm("æ¸…ç©ºï¼Ÿ")) { currentSlots = Array.from({length: 12}, () => ({ main: "ç©ºç¼º", sub: "ç©ºç¼º", lv: 15 })); render(); } }

        render();
    </script>
</body>
</html>
